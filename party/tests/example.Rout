
R : Copyright 2004, The R Foundation for Statistical Computing
Version 1.9.0 alpha (2004-03-14), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> invisible(options(echo = TRUE))
> 
> library(ipred)
Loading required package: rpart 
Loading required package: MASS 
Loading required package: mlbench 
Loading required package: survival 
Loading required package: class 
Loading required package: nnet 
> library(party)
> library(exactRankTests)
> source("./dendrogram.R")
> 
> data(BostonHousing)
> data(Ozone)
> data(GlaucomaM)
> 
> MFF = ModelFrame(medv ~ ., data = BostonHousing)
> 
> VarList = treedesign(MFF)
> VarList@control = new("GrowControl", minsplit = 20, 
+                        minstat = qnorm(1 - 0.05/ncol(MFF@input)))
> 
> Rprof("tree")
> x = stree(VarList)
> Rprof(NULL)
> show(x)
 1  Var:  lstat  cutpoint:  9.71 
  2  Var:  rm  cutpoint:  7.42 
    3  Var:  crim  cutpoint:  4.55587 
      4  Var:  rm  cutpoint:  6.718 
        5  Var:  lstat  cutpoint:  7.6 
          6  Var:  dis  cutpoint:  6.2196 
            7  Var:  lstat  cutpoint:  5.68 
            10  Var:  rm  cutpoint:  6.345 
          13  Var:  rm  cutpoint:  6.12 
        16  Var:  rm  cutpoint:  6.939 
          17  Var:  ptratio  cutpoint:  17.6 
    22  Var:  ptratio  cutpoint:  19.1 
      23  Var:  ptratio  cutpoint:  14.7 
  27  Var:  lstat  cutpoint:  16.03 
    28  Var:  b  cutpoint:  100.63 
      30  Var:  ptratio  cutpoint:  13 
        32  Var:  lstat  cutpoint:  14.37 
          34  Var:  age  cutpoint:  88.5 
    37  Var:  tax  cutpoint:  437 
      38  Var:  crim  cutpoint:  0.55778 
      41  Var:  lstat  cutpoint:  19.78 
        43  Var:  nox  cutpoint:  0.597 
> dx = as.dendrogram(x)
> save(dx, file = "dendrogram.Rda")
> plot(dx, center = TRUE)
> plot(dx)
> 
> index = c(51,100,120,29,150)
> pr = treepredict(x, VarList, MFF@input[index,])
> 
> a = rpart(medv ~ ., data = BostonHousing)
> print(a)
n= 506 

node), split, n, deviance, yval
      * denotes terminal node

 1) root 506 42716.3000 22.53281  
   2) rm< 6.941 430 17317.3200 19.93372  
     4) lstat>=14.4 175  3373.2510 14.95600  
       8) crim>=6.99237 74  1085.9050 11.97838 *
       9) crim< 6.99237 101  1150.5370 17.13762 *
     5) lstat< 14.4 255  6632.2170 23.34980  
      10) dis>=1.5511 248  3658.3930 22.93629  
        20) rm< 6.543 193  1589.8140 21.65648 *
        21) rm>=6.543 55   643.1691 27.42727 *
      11) dis< 1.5511 7  1429.0200 38.00000 *
   3) rm>=6.941 76  6059.4190 37.23816  
     6) rm< 7.437 46  1899.6120 32.11304  
      12) lstat>=9.65 7   432.9971 23.05714 *
      13) lstat< 9.65 39   789.5123 33.73846 *
     7) rm>=7.437 30  1098.8500 45.09667 *
> predict(a, newdata = BostonHousing[index,])
      51      100      120       29      150 
21.65648 33.73846 21.65648 21.65648 17.13762 
> pr
        [,1]
51  20.89459
100 33.35526
120 20.89459
29  20.89459
150 14.34091
> MFF@response[index,]
[1] 19.7 33.2 19.3 18.4 15.4
> 
> pr = treepredict(x, VarList, MFF@input)[,1]
> pro = predict(a)        
> re = range(c(pr, pro))
> #par(mfrow = c(1,3))
> plot(pr + rnorm(length(pr)), pro + rnorm(length(pro)), 
+      xlim = re, ylim = re)
> 
> plot(pr + rnorm(length(pr)), MFF@response[[1]] + rnorm(length(pro)), 
+      xlim = re, ylim = re)
> 
> plot(pro + rnorm(length(pro)), MFF@response[[1]] + rnorm(length(pro)), 
+      xlim = re, ylim = re)
> 
> 
> myOzone = Ozone[complete.cases(Ozone$V4),]
> MFF = ModelFrame(V4 ~ ., data = myOzone, na.action = na.pass)
> 
> VarList = treedesign(MFF)
> VarList@control = new("GrowControl", minsplit = 20, 
+                        minstat = qnorm(1 - 0.05/ncol(MFF@input)))
> 
> # Rprof("tree")
> x = stree(VarList)
> # Rprof(NULL)
> show(x)
 1  Var:  V8  cutpoint:  67 
  2  Var:  V8  cutpoint:  58 
    3  Var:  V10  cutpoint:  1899 
        5  Var:  V12  cutpoint:  64.4 
      9  Var:  V8  cutpoint:  39 
        10  Var:  V10  cutpoint:  3188 
          14  Var:  V12  cutpoint:  37.58 
    20  Var:  V10  cutpoint:  3539 
  23  Var:  V8  cutpoint:  79 
    24  Var:  V7  cutpoint:  59 
> dx = as.dendrogram(x)
> plot(dx, center = TRUE)
> plot(dx)
> 
> index = c(51,100,120,29,150)
> pr = treepredict(x, VarList, MFF@input[index,])
> 
> a = rpart(V4 ~ ., data  = myOzone)
> print(a)
n= 361 

node), split, n, deviance, yval
      * denotes terminal node

 1) root 361 22558.0000 11.526320  
   2) V8< 67.5 232  4416.0690  7.293103  
     4) V10>=3573.5 115   721.4435  5.069565 *
     5) V10< 3573.5 117  2567.1970  9.478632  
      10) V1=1,12 33   142.0606  5.424242 *
      11) V1=2,3,4,5,6,8,9,10,11 84  1669.5710 11.071430  
        22) V2=1,2,3,6,8,10,14,16,17,18,19,23,24,29,30 43   586.7907  8.930233 *
        23) V2=4,7,12,13,15,20,21,22,25,26,27,28,31 41   678.8780 13.317070  
          46) V5< 5735 18   112.4444 10.555560 *
          47) V5>=5735 23   321.7391 15.478260 *
   3) V8>=67.5 129  6507.4880 19.139530  
     6) V8< 79.5 85  3320.8940 16.564710  
      12) V2=2,3,4,5,6,8,9,11,12,15,16,19,22,23,29,30,31 50  1657.9200 13.960000  
        24) V11< -13.5 8    52.8750  6.125000 *
        25) V11>=-13.5 42  1020.4050 15.452380  
          50) V12< 73.04 34   447.5588 14.205880 *
          51) V12>=73.04 8   295.5000 20.750000 *
      13) V2=1,7,10,13,14,17,18,20,21,24,26,27 35   839.1429 20.285710 *
     7) V8>=79.5 44  1534.4320 24.113640  
      14) V2=1,2,8,9,10,11,14,15,18,23,24,25,26,27,31 25   626.6400 21.120000 *
      15) V2=4,5,6,7,12,13,19,20,21,28,29,30 19   388.9474 28.052630 *
> predict(a, newdata = myOzone[index,])
      51      100      120       29      151 
5.069565 5.069565 8.930233 5.424242 8.930233 
> pr
         [,1]
51   6.705882
100  6.705882
120 11.186441
29  11.186441
151 11.186441
> MFF@response[index,]
[1]  6 10 19  6 11
> 
> MFF = ModelFrame(Class ~ ., data = GlaucomaM)
> 
> 
> VarList = treedesign(MFF)
> VarList@control = new("GrowControl", minsplit = 20, 
+                        minstat = qnorm(1 - 0.05/ncol(MFF@input)))
> 
> # Rprof("tree")
> x = stree(VarList)
> # Rprof(NULL)
> dx = as.dendrogram(x)
> plot(dx, center = TRUE)
> plot(dx)
> 
> show(x)
 1  Var:  vari  cutpoint:  0.059 
  2  Var:  vasg  cutpoint:  0.066 
  5  Var:  tms  cutpoint:  -0.066 
> 
> index = c(51,100,120,29,150)
> pr = treepredict(x, VarList, MFF@input[index,])
> 
> a = rpart(Class ~ ., data = GlaucomaM)
> print(a)
n= 196 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 196 98 glaucoma (0.50000000 0.50000000)  
   2) varg< 0.209 76  6 glaucoma (0.92105263 0.07894737) *
   3) varg>=0.209 120 28 normal (0.23333333 0.76666667)  
     6) mhcg>=0.1695 7  0 glaucoma (1.00000000 0.00000000) *
     7) mhcg< 0.1695 113 21 normal (0.18584071 0.81415929)  
      14) vars< 0.064 19  9 glaucoma (0.52631579 0.47368421) *
      15) vars>=0.064 94 11 normal (0.11702128 0.88297872)  
        30) tms>=-0.0655 32  8 normal (0.25000000 0.75000000)  
          60) eas< 0.4455 7  2 glaucoma (0.71428571 0.28571429) *
          61) eas>=0.4455 25  3 normal (0.12000000 0.88000000) *
        31) tms< -0.0655 62  3 normal (0.04838710 0.95161290) *
> predict(a, newdata = GlaucomaM[index,])
      glaucoma     normal
17   0.0483871 0.95161290
272  0.9210526 0.07894737
44   0.9210526 0.07894737
94   0.9210526 0.07894737
5433 0.5263158 0.47368421
> pr
      glaucoma     normal
17   0.0923077 0.90769231
272  0.9367089 0.06329114
44   0.9367089 0.06329114
94   0.3863636 0.61363636
5433 0.9367089 0.06329114
> MFF@response[index,]
[1] normal   glaucoma glaucoma normal   glaucoma
Levels: glaucoma normal
> 
> 
> data(GBSG2)
> res = cscores(Surv(GBSG2$time, GBSG2$cens))
> dat = GBSG2[,-(9:10)]
> MFF = ModelFrame(res ~ ., data = dat)
> 
> 
> VarList = treedesign(MFF)
> VarList@control = new("GrowControl", minsplit = 20, 
+                        minstat = qnorm(1 - 0.05/ncol(MFF@input)))
> 
> # Rprof("tree")
> x = stree(VarList)
> # Rprof(NULL)
> 
> dx = as.dendrogram(x)
> plot(dx, center = TRUE)
> plot(dx)
> 
> show(x)
 1  Var:  pnodes  cutpoint:  3 
  5  Var:  progrec  cutpoint:  20 
    6  Var:  pnodes  cutpoint:  9 
> 
> Rprof("pred")
> pr = treepredict(x, VarList, MFF@input)
> Rprof(NULL)
> 
> VarList@control@minstat = 2.4
> show(stree(VarList))
 1  Var:  pnodes  cutpoint:  3 
  5  Var:  progrec  cutpoint:  20 
    6  Var:  pnodes  cutpoint:  9 
> 
> proc.time()
[1] 14.88  0.20 15.98  0.00  0.00
> 
